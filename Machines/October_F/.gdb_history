checksec
quit
checksec
b main
run
r `python -c 'print "A"*200'`
c
exit
quit
exit
quit
r Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag
exit
quit
r `python buf.py`
quit
b main
r
x/s 0x555555556004
si
gdb-peda$ si
[----------------------------------registers-----------------------------------]
RAX: 0x555555555135 (<main>:    push   rbp)
RBX: 0x0 
RCX: 0x7ffff7fad718 --> 0x7ffff7fafb00 --> 0x0 
RDX: 0x7fffffffe0d8 --> 0x7fffffffe412 ("SHELL=/usr/bin/zsh")
RSI: 0x7fffffffe0c8 --> 0x7fffffffe3e7 ("/home/kali/HTB/Machines/October_NF/retlibc")
RDI: 0x555555556004 --> 0x68732f6e69622f ('/bin/sh')
RBP: 0x7fffffffdfd0 --> 0x555555555150 (<__libc_csu_init>:      push   r15)
RSP: 0x7fffffffdfd0 --> 0x555555555150 (<__libc_csu_init>:      push   r15)
RIP: 0x555555555140 (<main+11>: call   0x555555555030 <system@plt>)
R8 : 0x0 
R9 : 0x7ffff7fe2180 (<_dl_fini>:        push   rbp)
R10: 0xb ('\x0b')
R11: 0x2 
R12: 0x555555555050 (<_start>:  xor    ebp,ebp)
R13: 0x0 
R14: 0x0 
R15: 0x0
EFLAGS: 0x246 (carry PARITY adjust ZERO sign trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
   0x555555555135 <main>:       push   rbp
   0x555555555136 <main+1>:     mov    rbp,rsp
   0x555555555139 <main+4>:     lea    rdi,[rip+0xec4]        # 0x555555556004
=> 0x555555555140 <main+11>:    call   0x555555555030 <system@plt>
   0x555555555145 <main+16>:    nop
   0x555555555146 <main+17>:    pop    rbp
   0x555555555147 <main+18>:    ret    
   0x555555555148:      nop    DWORD PTR [rax+rax*1+0x0]
Guessed arguments:
arg[0]: 0x555555556004 --> 0x68732f6e69622f ('/bin/sh')
[------------------------------------stack-------------------------------------]
0000| 0x7fffffffdfd0 --> 0x555555555150 (<__libc_csu_init>:     push   r15)
0008| 0x7fffffffdfd8 --> 0x7ffff7e15d0a (<__libc_start_main+234>:       mov    edi,eax)
0016| 0x7fffffffdfe0 --> 0x7fffffffe0c8 --> 0x7fffffffe3e7 ("/home/kali/HTB/Machines/October_NF/retlibc")
0024| 0x7fffffffdfe8 --> 0x100000000 
0032| 0x7fffffffdff0 --> 0x555555555135 (<main>:        push   rbp)
0040| 0x7fffffffdff8 --> 0x7ffff7e157cf (<init_cacheinfo+287>:  mov    rbp,rax)
0048| 0x7fffffffe000 --> 0x0 
0056| 0x7fffffffe008 --> 0xb9c39bcdef6f537c 
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value
0x0000555555555140 in main ()
gdb-peda$
sters-----------------------------------]
RAX: exit
sl
si
x/s 0x555555555145
si
x/s 0x555555555150
x/s 0x555555555145
x/s 0x7fffffffe3e7
x/s 0x555555556004
r
x/s 0x555555556004
si
si
si
si
si
si
si
si
si
si
r
si
si
x/s 0x7fffffffdfe8
x/s 0x7fffffffdfc8
quit
b main
r
x/s 0x555555555139
x/s 0x555555556004
quit
b main
r
si
si
si
si
x/s 0x7ffff7e157cf
si
si
si
si
si
si
si
si
si
si
si
quit
b main
r
x/s 0x555555555139
x/s 0x555555556004
quit
b main
r
si
x/s 0x555555555150
si
quit
p system
searchmem /bin/sh
r
searchmem /bin/sh
quit
r
p system
p system
quit
p system
searchmem /bin/sh
r
searchmem /bin/sh
x/s 0x68732f6e69622f
x/s 0x7ffff7f79156
searchmem /bin/sh
searchmem /bin/sh
p system
x/s 0x7ffff7e37df0
r
r `python buf.py`
disas main
quit
r
p system
searchmem /bin/bash
searchmem /bin/bash
r
searchmem /bin/bash
quit
p system
r
quit
p system
r
searchmem /bin/sh
x/s 0x7ffff7f79156
p system
r `python buf.py`
searchmem /bin/bash
r
quit
b main
p system
r
p system
searchmem /bin/bash
si
si
searchmem /bin/bash
cc
quit
b main
r
x/s 0x555555556004
searchmem /bin/sh
x/s 0x7ffff7f79156
p system
quit
